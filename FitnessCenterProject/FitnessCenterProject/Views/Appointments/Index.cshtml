@model IEnumerable<FitnessCenterProject.Models.Appointment>
@using FitnessCenterProject.Models

@{
    ViewData["Title"] = "Tüm Randevular";
}

<h1 class="mb-4">Tüm Randevular (Admin)</h1>

<div class="card shadow-sm">
    <div class="card-body">
        @if (!Model.Any())
        {
            <div class="alert alert-info mb-0">
                Sistemde kayıtlı randevu bulunmuyor.
            </div>
        }
        else
        {
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Tarih / Saat</th>
                            <th>Üye</th>
                            <th>Hizmet</th>
                            <th>Eğitmen</th>
                            <th>Ücret</th>
                            <th>Durum</th>
                            <th style="width: 230px;">İşlemler</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.OrderByDescending(a => a.StartDateTime))
                        {
                            string badgeClass;
                            switch (item.Status)
                            {
                                case AppointmentStatus.Pending:
                                    badgeClass = "badge bg-warning text-dark";
                                    break;
                                case AppointmentStatus.Approved:
                                    badgeClass = "badge bg-success";
                                    break;
                                case AppointmentStatus.Rejected:
                                    badgeClass = "badge bg-danger";
                                    break;
                                case AppointmentStatus.Cancelled:
                                    badgeClass = "badge bg-secondary";
                                    break;
                                default:
                                    badgeClass = "badge bg-light text-dark";
                                    break;
                            }

                            <tr>
                                <td>@item.StartDateTime.ToString("dd.MM.yyyy HH:mm")</td>
                                <td>@item.Member?.Email</td>
                                <td>@item.Service?.Name</td>
                                <td>
                                    @(item.Trainer != null
                                        ? item.Trainer.FirstName + " " + item.Trainer.LastName
                                        : "-")
                                </td>
                                <td>@item.Price.ToString("0.00") ₺</td>
                                <td>
                                    <span class="@badgeClass">
                                        @item.Status
                                    </span>
                                </td>
                                <td>
                                    <div class="btn-group btn-group-sm" role="group">
                                        @if (item.Status == AppointmentStatus.Pending)
                                        {
                                            <a asp-action="Approve"
                                               asp-route-id="@item.Id"
                                               class="btn btn-outline-success">
                                                Onayla
                                            </a>
                                            <a asp-action="Reject"
                                               asp-route-id="@item.Id"
                                               class="btn btn-outline-danger">
                                                Reddet
                                            </a>
                                        }

                                        <a asp-action="Details"
                                           asp-route-id="@item.Id"
                                           class="btn btn-outline-secondary">
                                            Detay
                                        </a>
                                        <a asp-action="Edit"
                                           asp-route-id="@item.Id"
                                           class="btn btn-outline-primary">
                                            Düzenle
                                        </a>
                                        <a asp-action="Delete"
                                           asp-route-id="@item.Id"
                                           class="btn btn-outline-danger">
                                            Sil
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>
