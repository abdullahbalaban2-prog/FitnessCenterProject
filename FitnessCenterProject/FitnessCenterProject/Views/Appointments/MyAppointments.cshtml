@model IEnumerable<FitnessCenterProject.Models.Appointment>
@using FitnessCenterProject.Models

@{
    ViewData["Title"] = "Randevularım";
}

<h1 class="neon-red arena-page-title mb-4">Randevularım</h1>

<div class="arena-card shadow-lg p-4">

    @if (!Model.Any())
    {
        <div class="alert arena-alert-empty text-center fw-bold">
            Henüz randevunuz bulunmuyor.<br />
            <a asp-action="Create" class="arena-link">Buradan yeni randevu alabilirsiniz.</a>
        </div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table arena-table table-borderless align-middle">
                <thead>
                    <tr>
                        <th>Tarih / Saat</th>
                        <th>Hizmet</th>
                        <th>Eğitmen</th>
                        <th>Süre</th>
                        <th>Ücret</th>
                        <th>Durum</th>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model.OrderByDescending(a => a.StartDateTime))
                    {
                        <tr>
                            <td class="fw-bold text-light">@item.StartDateTime.ToString("dd.MM.yyyy HH:mm")</td>
                            <td class="text-warning">@item.Service?.Name</td>
                            <td class="text-light">
                                @(item.Trainer != null
                                    ? item.Trainer.FirstName + " " + item.Trainer.LastName
                                    : "-")
                            </td>
                            <td class="text-light">
                                @(item.Service?.DurationMinutes ?? 0) dk
                            </td>
                            <td class="text-light">
                                @item.Price.ToString("0.00") ₺
                            </td>
                            <td>
                                <span class="badge arena-status @GetStatusClass(item.Status)">
                                    @item.Status
                                </span>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }

</div>

<div class="mt-4">
    <a asp-action="Create" class="btn arena-btn-lg">Yeni Randevu Al</a>
</div>

@functions {

    public string GetStatusClass(AppointmentStatus status)
    {
        return status switch
        {
            AppointmentStatus.Pending => "status-pending",
            AppointmentStatus.Approved => "status-approved",
            AppointmentStatus.Rejected => "status-rejected",
            AppointmentStatus.Cancelled => "status-cancelled",
            _ => "status-default"
        };
    }
}